{
  "template":{
    "body": [
      {
      "componentType":"instance",
      "persistentVolumeClaims":null,
      "deployments":[
        {
          "kind":"Deployment",
          "apiVersion":"extensions/v1beta1",
          "metadata":{
            "name":"$short_instance_id",
            "creationTimestamp":null,
            "labels":{
              "short_instance_id":"$short_instance_id",
              "managed_by":"TAP",
              "org":"$org",
              "instance_id":"$instance_id",
              "space":"$space"
            }
          },
          "spec":{
            "replicas":1,
            "selector":{
              "matchLabels":{
                "managed_by":"TAP",
                "short_instance_id":"$short_instance_id",
                "instance_id":"$instance_id"
              }
            },
            "template":{
              "metadata":{
                "creationTimestamp":null,
                "labels":{
                  "short_instance_id":"$short_instance_id",
                  "managed_by":"TAP",
                  "instance_id":"$instance_id"
                }
              },
              "spec":{
                "volumes":null,
                "containers":[
                  {
                    "name":"tapng-gateway",
                    "image":"$repository_uri/tapng-gateway",
                    "ports":[
                      {
                        "containerPort":8080,
                        "protocol":"TCP"
                      }
                    ],
                    "env":[
                      {
                        "name":"GATEWAY_ID",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"id"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_INDEX",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"index"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_TRACE",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"trace"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_SERVER_ROOT",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"server.root"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_SERVER_HOST",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"server.host"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_SERVER_PORT",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"server.port"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_SERVER_TOKEN",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"server.token"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_SERVER_AUTHMETHOD",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"server.authmethod"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_SERVER_DEVICEKEYSURI",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"server.devicekeysuri"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_SERVER_TOLERABLEJWTAGE",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"server.tolerablejwtage"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_PUB_URI",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"pub.uri"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_PUB_TOPIC",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"pub.topic"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_PUB_ACK",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"pub.ack"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_PUB_COMPRESS",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"pub.compress"
                          }
                        }
                      },
                      {
                        "name":"GATEWAY_PUB_FLUSHFREQ",
                        "valueFrom":{
                          "secretKeyRef":{
                            "name":"$short_instance_id-gateway-args",
                            "key":"pub.flushfreq"
                          }
                        }
                      },
                      {
                        "name":"MANAGED_BY",
                        "value":"TAP"
                      }
                    ],
                    "resources":{

                    },
                    "imagePullPolicy":"IfNotPresent"
                  }
                ],
                "restartPolicy":"Always",
                "dnsPolicy":"ClusterFirst",
                "serviceAccountName":""
              }
            },
            "strategy":{

            }
          },
          "status":{

          }
        }
      ],
      "services":[
        {
          "kind":"Service",
          "apiVersion":"v1",
          "metadata":{
            "name":"$short_instance_id",
            "creationTimestamp":null,
            "labels":{
              "short_instance_id":"$short_instance_id",
              "managed_by":"TAP",
              "org":"$org",
              "instance_id":"$instance_id",
              "space":"$space"
            }
          },
          "spec":{
            "type":"NodePort",
            "ports":[
              {
                "protocol":"TCP",
                "port":8080
              }
            ],
            "selector":{
              "instance_id":"$instance_id"
            }
          },
          "status":{
            "loadBalancer":{

            }
          }
        }
      ],
      "serviceAccounts":[
        {
          "kind":"ServiceAccount",
          "apiVersion":"v1",
          "metadata":{
            "name":"$short_instance_id",
            "creationTimestamp":null,
            "labels":{
              "short_instance_id":"$short_instance_id",
              "managed_by":"TAP",
              "org":"$org",
              "instance_id":"$instance_id",
              "space":"$space"
            }
          },
          "secrets":null
        }
      ],
      "secrets":[
        {
          "kind":"Secret",
          "apiVersion":"v1",
          "metadata":{
            "name":"$short_instance_id-gateway-args",
            "creationTimestamp":null,
            "labels":{
              "short_instance_id":"$short_instance_id",
              "managed_by":"TAP",
              "org":"$org",
              "instance_id":"$instance_id",
              "space":"$space"
            }
          },
          "data":{
            "server.host":"MC4wLjAuMA==",
            "server.root":"L3dz",
            "pub.ack":"ZmFsc2U=",
            "server.tolerablejwtage":"NQ==",
            "server.port":"ODA4MA==",
            "server.token":"",
            "index":"MA==",
            "trace":"dHJ1ZQ==",
            "pub.compress":"dHJ1ZQ==",
            "pub.topic":"bWVzc2FnZXM=",
            "pub.uri":"a2Fma2EtbW9jazo5MDky",
            "server.devicekeysuri":"",
            "server.authmethod":"bm9uZQ==",
            "pub.flushfreq":"MQ==",
            "id":"ZzE="
          }
        }
      ]
      }
    ],
    "hooks":null
  },
  "services":[
    {
      "name":"gateway",
      "description":"WebSocket to KAFKA gateway.",
      "bindable":true,
      "tags":[
        "k8s",
        "test"
      ],
      "plans":[
        {
          "name":"free",
          "description":"free",
          "cost":"free"
        }
      ]
    }
  ]
}

